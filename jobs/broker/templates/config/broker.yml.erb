---
broker:
  username: <%= p("servicebroker.username") %>
  password: <%= p("servicebroker.password") %>
  port: <%= p("servicebroker.port") %>

router:
  hostname: <%= p("servicebroker.router.hostname") %>

kvstore:
  type: etcd
  machines: <%= p("etcd.machines").map {|h| "http://#{h}:4001"} %>
  username: ""
  password: ""

<% if_p("backups.clusterdata.aws_access_key_id") do |aws_access_key_id| %>
callbacks:
  provision_success:
    cmd: /var/vcap/jobs/broker/bin/backup_provisioned_service
    args: []
<% end %>

backends:
<% p("servicebroker.backends.machines").each do |az, machines| %>
  <% machines.each do |machine| %>
- guid: <%= machine %>
  availability_zone: <%= az %>
  uri: <%= machine %>
  username: "<%= p('servicebroker.backends.username') %>"
  password: "<%= p('servicebroker.backends.password') %>"
  <% end %>
<% end %>

catalog:
  services: <%= JSON.pretty_generate(p('servicebroker.services')) %>
